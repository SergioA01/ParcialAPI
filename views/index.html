<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inicio</title>
    <script src="js/scripts.js"></script>
  </head>
  <body>
    <h1>PÃ¡gina de platos</h1>
    <label for="id">Ingresa el ID del producto:</label>
    <input type="text" id="id">
    <button onclick="buscarProducto()">Buscar</button>
  
    <div id="resultado"></div>
    <button onclick="redireccionarPagina()">Agregar plato</button>
    <br><br>
    <table border="1">
      <thead>
        <th>Id</th>
        <th>IdDish</th>
        <th>Name</th>
        <th>Calorias</th>
        <th>Vegeterian</th>
        <th>Valor</th>
        <th>Comentarios</th>
      </thead>
      <tbody id="tBody">
        <script>
          function redireccionarPagina() {
           window.location.href='/agregarPlato'
         }

         function buscarProducto() {
            const idDish = document.getElementById('id').value;
            const url = `https://api-dishes.vercel.app/`;
            const uri = url+`${idDish}`

            fetch(uri)
              .then(response => {
                if (!response.ok) {
                  throw new Error('Error en la solicitud.');
                }
                return response.json();
              })
              .then(data => {
                const resultado = document.getElementById('resultado');
                resultado.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
              })
              .catch(error => {
              
                const resultado = document.getElementById('resultado');
                resultado.innerHTML = `<div>Error: ${error.message}</div>`;
              });
          }

          loadData()
            .then((result) => {
              if( result.state ){
                const tBody = document.getElementById('tBody')

                result.data.forEach( plato => {
                  const row = document.createElement('tr')

                  const colId = document.createElement('td')

                  colId.appendChild(document.createTextNode(plato._id))

                  row.append(colId)

                  const colidDish = document.createElement('td')

                  colidDish.appendChild( document.createTextNode(plato.idDish))
                  row.appendChild(colidDish)

                  const colName = document.createElement('td')

                  colName.appendChild( document.createTextNode(plato.name))
                  row.appendChild(colName)

                  const colCalories = document.createElement('td')

                  colCalories.appendChild( document.createTextNode(plato.calories))
                  row.appendChild(colCalories)

                  const colVegetarian = document.createElement('td')

                  colVegetarian.appendChild( document.createTextNode(plato.isVegetarian))
                  row.appendChild(colVegetarian)

                  const colValor = document.createElement('td')

                  colValor.appendChild( document.createTextNode(plato.value))
                  row.appendChild(colValor)

                  const colComentarios = document.createElement('td')

                  colComentarios.appendChild( document.createTextNode(plato.comments))
                  row.appendChild(colComentarios)



                  tBody.appendChild(row)
                })
              }else{
                alert('Ho!! Algo ha salido mal')
              }
            })
            .catch(err=>console.log(err))
        </script>
      </tbody>
    </table>
  </body>
</html>
